steps:
  - apply:
      manifest:
        path: https://raw.githubusercontent.com/solo-io/gloo/v1.2.9/example/petstore/petstore.yaml
    docs:
      description: >
        We can run the following commands to deploy the application to Kubernetes. These yaml files contain the Kubernetes deployment and service
        definitions for the application.
      notes: >
        Make sure these pods are running by executing `kubectl get pod` and checking the readiness status for the two petclinic pods. It
        may take a few minutes to download the containers, depending on your connection.
  - apply:
      manifest:
        path: vs-petstore-1.yaml
    docs:
      title: Create a route in Gloo
      description: >
        Now we can create a gloo virtual service that adds a route to the petclinic application. Use `kubectl` to apply the following yaml:
      notes: >
        To easily copy a yaml snippet into a command, copy it to the clipboard then run `pbcopy | kubectl apply -f -`.
    renderAsYaml: true
  - curl:
      path: /sample-route-1
      statusCode: 200
      service:
        name: gateway-proxy
        namespace: gloo-system
    docs:
      title: Test the route
      description: |
        To test this route, we will leverage glooctl to help identify the URL for the proxy, and issue a curl request to it:

        `curl $(glooctl proxy url)/sample-route-1`

        This should return a 200 and the following json:
        ```
        [{"id":1,"name":"Dog","status":"available"},{"id":2,"name":"Cat","status":"pending"}]
        ```